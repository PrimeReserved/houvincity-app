import{ax as cn,r as c,ay as ut,az as ln,ak as un,j as a,aA as et,u as G,aB as Lt,ac as W,aC as dn,aD as dt,aE as pn,a3 as oe,aF as ye,a7 as L,aG as ee,aH as fn,l as te,aI as hn,aJ as mn,aK as pt,aL as vn,aM as ft,aN as gn,aO as Ee,a6 as ue,aP as ht,aQ as yn,aR as wn,aS as bn,aT as mt,aU as Se,a8 as Ce,E as Dt,aV as xn,w as Ut,aW as At,aX as jn,aY as kn,aZ as Ue,O as Pn,a_ as En,a$ as Sn,b0 as Cn,b1 as $n,a4 as In,b2 as Rn,b3 as Mt,b4 as _n,b5 as On,b6 as Wt,b7 as zn,b8 as Tn,b9 as Ln,H as Dn,ba as Be,bb as Ke,bc as Ve,bd as Un,be as An,bf as Mn,R as Nt,T as Ft,a as Wn,q as Bt,Z as Nn,ar as Kt,bg as Fn,D as Bn,bh as Kn}from"./sanity-f7d63e82.js";import{A as Vn,c as qn}from"./DisplayedDocumentBroadcaster-c7e74e05.js";function Jn({children:e,isValidProp:t,...n}){t&&cn(t),n={...c.useContext(ut),...n},n.isStatic=ln(()=>n.isStatic);const r=c.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return c.createElement(ut.Provider,{value:r},e)}const Gn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/_key\s*==\s*['"](.*)['"]/,Hn=/^\d*:\d*$/;function nt(e){return typeof e=="number"||typeof e=="string"&&/^\[\d+\]$/.test(e)}function Ie(e){return typeof e=="string"?tt.test(e.trim()):typeof e=="object"&&"_key"in e}function Vt(e){if(typeof e=="string"&&Hn.test(e))return!0;if(!Array.isArray(e)||e.length!==2)return!1;const[t,n]=e;return(typeof t=="number"||t==="")&&(typeof n=="number"||n==="")}function Xn(e,t,n){const r=typeof t=="string"?qt(t):t;if(!Array.isArray(r))throw new Error("Path must be an array or a string");let i=e;for(let o=0;o<r.length;o++){const l=r[o];if(nt(l)){if(!Array.isArray(i))return n;i=i[l]}if(Ie(l)){if(!Array.isArray(i))return n;i=i.find(m=>m._key===l._key)}if(typeof l=="string"&&(i=typeof i=="object"&&i!==null?i[l]:void 0),typeof i>"u")return n}return i}function Zn(e){if(!Array.isArray(e))throw new Error("Path is not an array");return e.reduce((t,n,r)=>{const i=typeof n;if(i==="number")return`${t}[${n}]`;if(i==="string")return`${t}${r===0?"":"."}${n}`;if(Ie(n)&&n._key)return`${t}[_key=="${n._key}"]`;if(Array.isArray(n)){const[o,l]=n;return`${t}[${o}:${l}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function qt(e){if(typeof e!="string")throw new Error("Path is not a string");const t=e.match(Gn);if(!t)throw new Error("Invalid path string");return t.map(Qn)}function Qn(e){return nt(e)?Yn(e):Ie(e)?er(e):Vt(e)?tr(e):e}function Yn(e){return Number(e.replace(/[^\d]/g,""))}function er(e){return{_key:e.match(tt)[1]}}function tr(e){const[t,n]=e.split(":").map(r=>r===""?r:Number(r));return[t,n]}var Jt=Object.freeze({__proto__:null,fromString:qt,get:Xn,isIndexSegment:nt,isIndexTuple:Vt,isKeySegment:Ie,reKeySegment:tt,toString:Zn});const vt="drafts.";function Ci(e){return e.startsWith(vt)?e.slice(vt.length):e}const gt={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},yt={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function nr(e){return`$${e.map(t=>typeof t=="string"?`['${t.replace(/[\f\n\r\t'\\]/g,n=>gt[n])}']`:typeof t=="number"?`[${t}]`:t._key!==""?`[?(@._key=='${t._key.replace(/['\\]/g,n=>gt[n])}')]`:`[${t._index}]`).join("")}`}function $i(e){const t=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let r;for(;(r=n.exec(e))!==null;){if(r[1]!==void 0){const i=r[1].replace(/\\(\\|f|n|r|t|')/g,o=>yt[o]);t.push(i);continue}if(r[2]!==void 0){t.push(parseInt(r[2],10));continue}if(r[3]!==void 0){const i=r[3].replace(/\\(\\')/g,o=>yt[o]);t.push({_key:i,_index:-1});continue}}return t}function rr(e){return e.map(t=>{if(typeof t=="string"||typeof t=="number")return t;if(t._index!==-1)return t._index;throw new Error(`invalid segment:${JSON.stringify(t)}`)})}function Ii(e,t){if(!(t!=null&&t.mappings))return;const n=nr(rr(e));if(t.mappings[n]!==void 0)return{mapping:t.mappings[n],matchedPath:n,pathSuffix:""};const r=Object.entries(t.mappings).filter(([m])=>n.startsWith(m)).sort(([m],[d])=>d.length-m.length);if(r.length==0)return;const[i,o]=r[0],l=n.substring(i.length);return{mapping:o,matchedPath:i,pathSuffix:l}}function ir(e){return e!==null&&Array.isArray(e)}function wt(e){return typeof e=="object"&&e!==null}function Ae(e,t,n=[]){return ir(e)?e.map((r,i)=>{if(wt(r)){const o=r._key;if(typeof o=="string")return Ae(r,t,n.concat({_key:o,_index:i}))}return Ae(r,t,n.concat(i))}):wt(e)?Object.fromEntries(Object.entries(e).map(([r,i])=>[r,Ae(i,t,n.concat(r))])):t(e,n)}const Gt="sanity.previewUrlSecret",or="sanity-preview-url-secret",ar="2023-11-09",Re="sanity-preview-secret",rt="sanity-preview-pathname",sr=3600,cr=`*[_type == "${Gt}" && dateTime(_updatedAt) <= dateTime(now()) - 3600]`,lr="sanity.preview-url-secret";function ur(e){const t=new URL(e);return t.searchParams.delete(rt),t.searchParams.delete(Re),t}function dr(e){return e.searchParams.has(Re)}function pr(e,t,n){const r=new URL(e);return r.searchParams.set(Re,t),r.searchParams.set(rt,n),r}async function Ht(e,t,n,r,i=un()){const o=e.withConfig({apiVersion:ar});try{const l=new Date(Date.now()+1e3*sr),m=`${or}.${i}`,d=function(){if(typeof crypto<"u"){const p=new Uint8Array(16);crypto.getRandomValues(p);let s="";for(let f=0;f<p.length;f++)s+=p[f].toString(16).padStart(2,"0");return s=btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),s}return Math.random().toString(36).slice(2)}(),h=o.patch(m).set({secret:d,source:t,studioUrl:n,userId:r});return await o.transaction().createOrReplace({_id:m,_type:Gt}).patch(h).commit({tag:lr}),{secret:d,expiresAt:l}}finally{await o.delete({query:cr})}}function fr(e){const{draftMode:t,previewMode:n,origin:r=typeof location>"u"?"https://localhost":location.origin}=e,i=(n==null?void 0:n.enable)||(t==null?void 0:t.enable);let{preview:o="/"}=e;const l=new URL(o,r),m=i?new URL(i,r):void 0;return async d=>{try{if(d.previewSearchParam){const p=new URL(d.previewSearchParam,l);p.origin===l.origin&&(o=`${p.pathname}${p.search}`)}else if(d.referrer){const p=new URL(d.referrer);p.origin===l.origin&&(o=`${p.pathname}${p.search}`)}}catch{}typeof location<"u"&&location.origin===l.origin&&d.studioBasePath&&(o.startsWith(`${d.studioBasePath}/`)||o===d.studioBasePath)&&(o=e.preview||"/");const h=new URL(o,l);if(m){const p=new URL(m),{searchParams:s}=p;return s.set(Re,d.previewUrlSecret),h.pathname!==p.pathname&&s.set(rt,`${h.pathname}${h.search}`),p.toString()}return h.toString()}}const hr=e=>typeof e=="object"&&typeof e.then=="function",xe=[];function mr(e,t,n=(r,i)=>r===i){if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}function vr(e,t=null,n=!1,r={}){t===null&&(t=[e]);for(const o of xe)if(mr(t,o.keys,o.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return r.lifespan&&r.lifespan>0&&(o.timeout&&clearTimeout(o.timeout),o.timeout=setTimeout(o.remove,r.lifespan)),o.response;if(!n)throw o.promise}const i={keys:t,equal:r.equal,remove:()=>{const o=xe.indexOf(i);o!==-1&&xe.splice(o,1)},promise:(hr(e)?e:e(...t)).then(o=>{i.response=o,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(o=>i.error=o)};if(xe.push(i),!n)throw i.promise}const bt=(e,t,n)=>vr(e,t,!1,n);var gr=Object.defineProperty,yr=(e,t,n)=>(((r,i,o)=>{i in r?gr(r,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[i]=o})(e,typeof t!="symbol"?t+"":t,n),n);let je;const wr=new Uint8Array(16);function br(){if(!je&&(je=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!je))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return je(wr)}const M=[];for(let e=0;e<256;++e)M.push((e+256).toString(16).slice(1));var xt={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function ke(e,t,n){if(xt.randomUUID&&!t&&!e)return xt.randomUUID();const r=(e=e||{}).random||(e.rng||br)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let i=0;i<16;++i)t[n+i]=r[i];return t}return function(i,o=0){return M[i[o+0]]+M[i[o+1]]+M[i[o+2]]+M[i[o+3]]+"-"+M[i[o+4]]+M[i[o+5]]+"-"+M[i[o+6]]+M[i[o+7]]+"-"+M[i[o+8]]+M[i[o+9]]+"-"+M[i[o+10]]+M[i[o+11]]+M[i[o+12]]+M[i[o+13]]+M[i[o+14]]+M[i[o+15]]}(r)}const xr=1e3,jr=1e3,kr=500,Pr=["handshake/syn","handshake/syn-ack","handshake/ack"],jt=e=>Pr.some(t=>t===e),Er=({data:e={}})=>typeof e=="object"&&e!==null&&!Array.isArray(e)&&!("domain"in e)&&["id","type","from","to"].every(t=>t in e)&&e.type.startsWith("handshake/");function kt(e){const t=e.target,n=e.connectTo.map(s=>({buffer:[],config:s,id:"",handler:i,status:"connecting",interval:void 0,heartbeat:void 0}));function r(s){window.clearInterval(s.interval)}function i(s){const{data:f}=s;if(jt(f.type)){const u=n.find(g=>g.config.id===f.from);u&&f.type==="handshake/syn-ack"&&(d(u,"connected"),h(u,"handshake/ack",{id:u.id}))}}const o=s=>{var f,u,g;const b=s.data;if(!jt(b.type)&&n.find(v=>v.id===b.connectionId)){const v=n.find(w=>w.config.id===b.from);if(v){const w=[b.type,b.data];(u=(f=v.config).onEvent)==null||u.call(f,...w),(g=e.onEvent)==null||g.call(e,...w),p(v,"channel/response",{responseTo:b.id},!1)}}};function l(s){var f;if(Er(s))console.error(`Visual editing package mismatch detected! Please ensure you are using the latest version of Sanity Studio and any packages listed here:
https://github.com/sanity-io/visual-editing`);else if(function(u){const{data:g,origin:b}=u;return g.domain==="sanity/channels"&&g.to==e.id&&n.map(v=>v.config.id).includes(g.from)&&g.type!=="channel/response"&&b===e.targetOrigin}(s)){const{data:u}=s;(f=n.find(g=>g.config.id===u.from))==null||f.handler(s)}}function m(s){s.heartbeat&&window.clearInterval(s.heartbeat)}function d(s,f){var u,g,b;s.status=f,(g=(u=s.config).onStatusUpdate)==null||g.call(u,f,s.config.id),(b=e.onStatusUpdate)==null||b.call(e,f,s.config.id),f==="connecting"||f==="reconnecting"?(s.handler=i,m(s),function(v){v.id=ke(),v.interval=window.setInterval(()=>{h(v,"handshake/syn",{id:v.id})},kr)}(s)):f==="connected"?(s.handler=o,r(s),function(v){if(m(v),v.config.heartbeat){const w=typeof v.config.heartbeat=="number"?v.config.heartbeat:jr;v.heartbeat=window.setInterval(()=>{p(v,"channel/heartbeat")},w)}}(s),function(v){const w=[...v.buffer];v.buffer.splice(0,v.buffer.length),w.forEach(({type:y,data:P})=>{p(v,y,P)})}(s)):f==="disconnected"&&(s.id=null,s.handler=i,r(s),m(s))}function h(s,f,u){if(!s.id)throw new Error("No channel ID set");const g={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:ke(),to:s.config.id,type:f};try{t==null||t.postMessage(g,{targetOrigin:"*"})}catch{throw new Error(`Failed to postMessage '${g.id}' on '${e.id}'`)}}function p(s,f,u,g=!0){const b=ke();if(s.status==="connecting"||s.status==="reconnecting"||s.status==="disconnected")return void s.buffer.push({type:f,data:u});if(!s.id)throw new Error("No channel ID set");const v={connectionId:s.id,data:u,domain:"sanity/channels",from:e.id,id:b,to:s.config.id,type:f};if(g){const w=setTimeout(()=>{v.connectionId===s.id&&(window.removeEventListener("message",y,!1),f!=="channel/heartbeat"&&s.buffer.push({type:f,data:u}),d(s,"reconnecting"),console.warn(`Received no response to message '${v.type}' on client '${e.id}' (ID: '${v.id}').`))},xr),y=P=>{var k;const{data:j}=P;j.type==="channel/response"&&(k=j.data)!=null&&k.responseTo&&j.data.responseTo===v.id&&(window.removeEventListener("message",y,!1),clearTimeout(w))};window.addEventListener("message",y,!1)}try{t==null||t.postMessage(v,{targetOrigin:e.targetOrigin})}catch{throw new Error(`Failed to postMessage '${v.id}' on client '${e.id}'`)}}return window.addEventListener("message",l,!1),n.forEach(s=>{d(s,"connecting")}),{destroy:function(){n.forEach(s=>{["disconnected"].includes(s.status)||(p(s,"channel/disconnect",{id:s.id},!1),d(s,"disconnected"))}),window.removeEventListener("message",l,!1),n.forEach(s=>{m(s),r(s)})},send:function(s,f,u){(s?Array.isArray(s)?[...s]:[s]:n).forEach(g=>{const b=n.find(v=>v.config.id===g);if(!b)throw new Error("Invalid channel ID");p(b,f,u)})}}}var Sr=class extends Error{constructor(e){super(e[0].message),yr(this,"issues"),this.name="ValiError",this.issues=e}};function qe(e,t){return Array.isArray(e)?[void 0,e]:[e,t]}function Xt(e,t,n,r,i){var o,l,m,d,h;const p=(h=(d=(m=(l=(o=t.message)!=null?o:function(s,f){var u;return(u=void 0)==null?void 0:u.get(f)}(n,i.lang))!=null?l:e?(i.lang,void 0):null)!=null?m:r==null?void 0:r.message)!=null?d:function(s){}(i.lang))!=null?h:i.message;return typeof p=="function"?p(i):p}function _e(e,t,n){return{typed:e,output:t,issues:n}}function it(e){let t=typeof e;return t==="object"&&(t=e?Object.getPrototypeOf(e).constructor.name:"null"),t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t}function Cr(e,t,n){var r;const i=(r=n.received)!=null?r:it(n.input),o={reason:e.type,context:n.context.type,expected:n.context.expects,received:i,message:`Invalid ${n.label}: ${n.context.expects?`Expected ${n.context.expects} but r`:"R"}eceived ${i}`,input:n.input,requirement:n.context.requirement,path:n.path,lang:t==null?void 0:t.lang,abortEarly:t==null?void 0:t.abortEarly,abortPipeEarly:t==null?void 0:t.abortPipeEarly,skipPipe:t==null?void 0:t.skipPipe};return o.message=Xt(!1,n.context,n.reference,t,o),o}function Zt(e,t,n,r){if(e.pipe&&(n==null||!n.skipPipe))for(const i of e.pipe){const o=i._parse(t);if(o.issues){for(const l of o.issues){const m=Cr(e,n,l);r?r.push(m):r=[m]}if(n!=null&&n.abortEarly||n!=null&&n.abortPipeEarly)break}else t=o.output}return _e(!0,t,r)}function ot(e,t,n,r,i){var o,l;const m=it(n),d=(o=i==null?void 0:i.expected)!=null?o:e.expects,h={reason:(l=i==null?void 0:i.reason)!=null?l:"type",context:e.type,expected:d,received:m,message:`Invalid type: Expected ${d} but received ${m}`,input:n,path:i==null?void 0:i.path,issues:i==null?void 0:i.issues,lang:r==null?void 0:r.lang,abortEarly:r==null?void 0:r.abortEarly,abortPipeEarly:r==null?void 0:r.abortPipeEarly,skipPipe:r==null?void 0:r.skipPipe};return h.message=Xt(!0,e,t,r,h),{typed:!1,output:n,issues:[h]}}function Qt(e,t){return{...e,fallback:t,_parse(n,r){const i=e._parse(n,r);return i.issues?_e(!0,function(o,l){return typeof o.fallback=="function"?o.fallback(l):o.fallback}(this,{input:n,issues:i.issues})):i}}}function Pe(e,t,n,r){const[i,o,l]=function(d,h,p){if(!d||typeof d=="object"&&!Array.isArray(d)){const[u,g]=qe(h,p);return[d,u,g]}const[s,f]=qe(d,h);return[void 0,s,f]}(t,n,r);let m;return{type:"object",expects:"Object",async:!1,entries:e,rest:i,message:o,pipe:l,_parse(d,h){if(d&&typeof d=="object"){m=m??Object.entries(this.entries);let p,s=!0;const f={};for(const[u,g]of m){const b=d[u],v=g._parse(b,h);if(v.issues){const w={type:"object",origin:"value",input:d,key:u,value:b};for(const y of v.issues)y.path?y.path.unshift(w):y.path=[w],p==null||p.push(y);if(p||(p=v.issues),h!=null&&h.abortEarly){s=!1;break}}v.typed||(s=!1),(v.output!==void 0||u in d)&&(f[u]=v.output)}if(this.rest&&(h==null||!h.abortEarly||!p)){for(const u in d)if(!(u in this.entries)){const g=d[u],b=this.rest._parse(g,h);if(b.issues){const v={type:"object",origin:"value",input:d,key:u,value:g};for(const w of b.issues)w.path?w.path.unshift(v):w.path=[v],p==null||p.push(w);if(p||(p=b.issues),h!=null&&h.abortEarly){s=!1;break}}b.typed||(s=!1),f[u]=b.output}}return s?Zt(this,f,h,p):_e(!1,f,p)}return ot(this,Pe,d,h)}}}function Oe(e,t){return{type:"picklist",expects:e.map(it).join(" | "),async:!1,options:e,message:t,_parse(n,r){return this.options.includes(n)?_e(!0,n):ot(this,Oe,n,r)}}}function Je(e,t,n){const r=e._parse(t,function(i){var o,l,m,d;return{lang:(o=i==null?void 0:i.lang)!=null?o:void 0,message:i==null?void 0:i.message,abortEarly:(l=i==null?void 0:i.abortEarly)!=null?l:void 0,abortPipeEarly:(m=i==null?void 0:i.abortPipeEarly)!=null?m:void 0,skipPipe:(d=i==null?void 0:i.skipPipe)!=null?d:void 0}}(n));if(r.issues)throw new Sr(r.issues);return r.output}const $r=/^([A-Za-z]+):([0-9]+)$/,Ir=/^([A-Za-z]+):([0-9]+),([0-9]+)$/,Rr=/^([A-Za-z]+):([a-z0-9]+)$/,Pt={alt:"altKey",ctrl:"ctrlKey",mod:typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};function Et(e){return e.key==="Alt"}function at(e){const{children:t,message:n,onRetry:r,onContinueAnyway:i,...o}=e,l=a.jsx(ee,{fontSize:1,mode:"ghost",onClick:r,text:"Retry"}),m=a.jsx(ee,{fontSize:1,mode:"ghost",tone:"critical",onClick:i,text:"Continue anyway"});return a.jsx(oe,{height:"fill",...o,children:a.jsx(W,{align:"center",height:"fill",justify:"center",children:a.jsx(In,{padding:4,sizing:"border",width:0,children:a.jsxs(ue,{space:4,children:[a.jsxs(ue,{space:3,children:[a.jsx(L,{size:1,weight:"semibold",children:"An error occured"}),a.jsx(L,{muted:!0,size:1,children:n})]}),t,r&&i?a.jsxs(Rn,{space:2,children:[l,m]}):r?a.jsx(te,{children:l}):i?a.jsx(te,{children:m}):null]})})})})}function ze(){const e=c.useContext(Mt);if(!e)throw new Error("Presentation context is missing");return e}function _r(e){const t=["comment","inspect","instruction","pathKey","rev","since","template","view"];return function(n={}){const r=Object.entries(n).map(([i,o])=>`${i}=${o}`).join("&");return r.length?`?${r}`:""}(Object.entries(e).filter(([n])=>t.includes(n)).reduce((n,[r,i])=>i==null?n:{...n,[r]:i},{}))}const Or=c.forwardRef(function(e,t){const{deskParams:n,params:r}=ze();return a.jsx(et,{...e,ref:t,state:{type:void 0,_searchParams:Object.entries({...n,preview:r.preview})},title:void 0})}),zr=c.forwardRef(function(e,t){const{documentId:n,documentType:r,parentRefPath:i,template:o,...l}=e;return a.jsx(et,{...l,ref:t,state:{id:n,type:r,_searchParams:Object.entries({preview:e.previewUrl})},title:void 0})});function Yt(e){const{children:t,params:n,onDeskParams:r,previewUrl:i,refs:o}=e,{state:l,resolvePathFromState:m}=Ut(),d=At(Object.fromEntries(l._searchParams||[])),h=c.useCallback(s=>`${m(l)}${_r({...d,...s})}`,[m,d,l]),p=c.useMemo(()=>({index:0,groupIndex:0,siblingIndex:0,payload:{},params:n,hasGroupSiblings:!1,groupLength:1,routerPanesState:[],ChildLink:s=>{const{childId:f,...u}=s,g=o==null?void 0:o.find(b=>b._id===f||Bt(b._id)===f);return g?a.jsx(et,{...u,state:{id:f,type:g._type,_searchParams:Object.entries({preview:i})}}):a.jsx("div",{...u})},BackLink:Or,ReferenceChildLink:s=>a.jsx(zr,{...s,previewUrl:i}),ParameterizedLink:()=>a.jsx(a.Fragment,{children:"ParameterizedLink"}),closeCurrentAndAfter:()=>{console.warn("closeCurrentAndAfter")},handleEditReference:s=>{console.warn("handleEditReference",s)},replaceCurrent:s=>{console.warn("replaceCurrent",s)},closeCurrent:()=>{console.warn("closeCurrent")},duplicateCurrent:s=>{console.warn("duplicateCurrent",s)},setView:s=>{console.warn("setView",s)},setParams:s=>{var f;r({...s,inspect:(f=s.inspect)!=null?f:void 0})},setPayload:s=>{console.warn("setPayload",s)},navigateIntent:(s,f,u)=>{console.warn("navigateIntent",s,f,u)},createPathWithParams:h}),[h,r,n,i,o]);return a.jsx(Nn.Provider,{value:p,children:t})}const Tr=G(Kt)`
  height: 100%;
`,Lr=G(W)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,Dr=G(Ce)`
  white-space: pre-wrap;
`;function Ur(e){const{onDeskParams:t,previewUrl:n,refs:r}=e,{devMode:i}=ze(),o=c.useMemo(()=>({id:"$root",options:{filter:"_id in $ids",params:{ids:r.map(p=>p._id)}},schemaTypeName:"",title:"Documents on this page",type:"documentList"}),[r]),[l,m]=c.useState(null),d=c.useCallback(()=>m(null),[]),[h]=c.useState(()=>({}));return c.useEffect(()=>m(null),[r]),l?a.jsx(at,{flex:1,message:"Could not render the document list",onRetry:d,children:i&&a.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(ue,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Dr,{size:1,children:l.error.message})]})})}):a.jsx(Nt,{onCatch:m,children:a.jsx(Tr,{children:a.jsx(Ft,{children:a.jsx(Yt,{params:h,onDeskParams:t,previewUrl:n,refs:r,children:a.jsx(Lr,{direction:"column",flex:1,children:a.jsx(Wn,{index:0,itemId:"$root",pane:o,paneKey:"$root"})})})})})})}const Ar=G(Ce)`
  white-space: pre-wrap;
`;function Mr(e){const{documentId:t,documentType:n,params:r,onDeskParams:i,onFocusPath:o,previewUrl:l}=e,{template:m,templateParams:d}=r,{devMode:h}=ze(),p=c.useMemo(()=>({id:t,options:{id:t,type:n,template:m,templateParameters:Fn(d)},title:"",type:"document"}),[t,n,m,d]),[s,f]=c.useState(null),u=c.useCallback(()=>f(null),[]);return c.useEffect(()=>{f(null)},[t,n,r]),s?a.jsx(at,{flex:1,message:"Could not render the document editor",onRetry:u,children:h&&a.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:a.jsxs(ue,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Error message"}),a.jsx(Ar,{size:1,children:s.error.message})]})})}):a.jsx(Nt,{onCatch:f,children:a.jsx(Kt,{style:{height:"100%"},children:a.jsx(Yt,{onDeskParams:i,params:r,previewUrl:l,children:a.jsx(Bn,{paneKey:"document",index:1,itemId:"document",pane:p,onFocusPath:o})})})})}function Wr(e){const{deskParams:t,documentId:n,documentType:r,onDeskParams:i,onFocusPath:o,previewUrl:l}=e;return a.jsx(Ft,{children:a.jsx(Mr,{documentId:n,documentType:r,params:t,onDeskParams:i,onFocusPath:o,previewUrl:l})})}function Nr(e){const{deskParams:t,documentId:n,documentType:r,onDeskParams:i,onFocusPath:o,previewUrl:l,refs:m}=e;return n&&r?a.jsx(Wr,{deskParams:t,documentId:n,documentType:r,onDeskParams:i,onFocusPath:o,previewUrl:l}):a.jsx(Ur,{onDeskParams:i,previewUrl:l,refs:m})}const Te=c.createContext(null);Te.displayName="PanelsContext";const Fr=G.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,Ge=function({children:e,defaultSize:t=null,id:n,minWidth:r,maxWidth:i,order:o=0}){const l=c.useContext(Te);if(l===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:m,registerElement:d,unregisterElement:h}=l,p=m(n);return c.useLayoutEffect(()=>(d(n,{id:n,type:"panel",defaultSize:t,maxWidth:i??null,minWidth:r??0,order:o}),()=>{h(n)}),[n,t,o,i,r,d,h]),a.jsx(Fr,{style:p,children:e})},Br=G.div`
  position: relative;
`,Kr=G.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:e})=>e?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:e})=>!e&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,en=function({id:e,order:t,disabled:n=!1}){const r=c.useRef(null),i=c.useContext(Te);if(i===null)throw Error("Panel components must be rendered within a PanelGroup container");const o=function(v){return c.useRef(v||ke()).current}(e),{activeResizer:l,drag:m,startDragging:d,stopDragging:h,registerElement:p,unregisterElement:s}=i,f=l===o;if(i===null)throw Error("Panel components must be rendered within a PanelGroup container");const u=c.useCallback(v=>{d(o,v.nativeEvent)},[o,d]),g=c.useCallback(v=>{m(o,v)},[o,m]),b=c.useCallback(()=>{r.current.blur(),h()},[h]);return c.useEffect(()=>{if(f&&!n)return window.addEventListener("mousemove",g),window.addEventListener("mouseup",b),()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",b)}},[n,f,g,b]),c.useLayoutEffect(()=>(p(o,{id:o,order:t,type:"resizer",el:r}),()=>{s(o)}),[o,t,p,s]),a.jsx(Br,{onMouseDown:u,ref:r,children:a.jsxs(Kr,{$disabled:n,children:[a.jsx("span",{}),a.jsx("span",{})]})})};function tn(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(e,r)},t)}}const nn="presentation/panels",St=()=>JSON.parse(localStorage.getItem(nn)||"{}"),Ct=e=>e.map(t=>[t.id,t.order].join(":")).join(",");function Vr(){return c.useMemo(()=>{const e=(t,n)=>{(r=>{localStorage.setItem(nn,JSON.stringify(r))})({...St(),[Ct(t)]:n})};return{get:t=>St()[Ct(t)],set:e,setDebounced:tn(e,100)}},[])}function He(e,t,n){const{maxWidth:r,minWidth:i}=e,o=r==null?100:r/n*100,l=i/n*100;return Math.min(o,Math.max(l,t))}function qr(e,t,n){if(e.length===1)return"100";const r=n[e.findIndex(i=>i.id===t)];return r==null?"0":r.toPrecision(10)}function $t(e,t,n=0,r=null){return e.clientX-(r||t.getBoundingClientRect()).left-n}function Me(e){return e.type==="panel"}function It(e){return e.type==="resizer"}function Rt(e){return Array.from(e.values()).sort(({order:t},{order:n})=>t==null&&n==null?0:t==null?-1:n==null?1:t-n)}function _t(e,t,n){const r=t.reduce((l,m)=>l+m,0),i=[...t].map(l=>l/r*100);let o=0;for(let l=0;l<e.length;l++){const m=e[l],d=i[l],h=He(m,d,n);d!=h&&(o+=d-h,i[l]=h)}if(o.toFixed(3)!=="0.000")for(let l=0;l<e.length;l++){const m=e[l];let{maxWidth:d,minWidth:h}=m;h=h/n*100,d!=null&&(d=d/n*100);const p=Math.min(d??100,Math.max(h,i[l]+o));if(p!==i[l]&&(o-=p-i[l],i[l]=p,Math.abs(o).toFixed(3)==="0.000"))break}return i}const Jr=G.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,Gr=function({children:e}){const t=c.useRef(null),[n,r]=c.useState(new Map),i=c.useMemo(()=>Rt(n).filter(Me),[n]),[o,l]=c.useState([]),[m,d]=c.useState(null),h=c.useRef({elements:n,panels:i,widths:o}),p=c.useCallback(P=>({flexGrow:qr(i,P,o),pointerEvents:m===null?void 0:"none"}),[m,i,o]),s=c.useCallback((P,k)=>{r(j=>{if(j.has(P))return j;const S=new Map(j);return S.set(P,k),S})},[]),f=c.useCallback(P=>{r(k=>{if(!k.has(P))return k;const j=new Map(k);return j.delete(P),j})},[]),u=c.useRef({containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]}),g=c.useCallback((P,k)=>{const j=Rt(n),S=j.findIndex(I=>I.id===P),R=n.get(P);if(!R||!It(R))return;const O=R.el.current;O&&(u.current={resizerIndex:S,panelBefore:j.reduce((I,z,_)=>Me(z)&&_<S?z:I,null),panelAfter:j.reduce((I,z,_)=>I===null&&Me(z)&&_>S?z:I,null),containerWidth:window.innerWidth,startX:k.pageX,dragOffset:$t(k,O),resizerRect:O.getBoundingClientRect(),widths:h.current.widths},d(P))},[n]),b=c.useCallback(()=>{d(null)},[]),v=c.useCallback((P,k)=>{k.preventDefault(),k.stopPropagation();const{containerWidth:j,dragOffset:S,panelBefore:R,panelAfter:O,resizerRect:I}=u.current;if(R==null||O==null)return;const z=n.get(P);if(!z||!It(z))return;const _=z.el.current;if(!_)return;const fe=$t(k,_,S,I);if(fe===0)return;const{widths:ne}=h.current,he=function(D,re,U,ae,se,me){const{panels:H,widths:ie}=se,{widths:N}=me,F=N||ie,de=[...F];{const Z=D<0?ae:U,V=F[H.findIndex(Le=>Le.id===Z.id)],Q=He(Z,V+Math.abs(D),re);if(V===Q)return F;D=D<0?V-Q:Q-V}let pe=0,ve=D<0?U:ae,X=H.findIndex(Z=>Z.id===ve.id);for(;;){const Z=H[X],V=F[X],Q=He(Z,V-(Math.abs(D)-Math.abs(pe)),re);if(V!==Q&&(pe+=V-Q,de[X]=Q,pe.toPrecision(10).localeCompare(Math.abs(D).toPrecision(10),void 0,{numeric:!0})>=0))break;if(D<0){if(--X<0)break}else if(++X>=H.length)break}return pe===0?F:(ve=D<0?ae:U,X=H.findIndex(Z=>Z.id===ve.id),de[X]=F[X]+pe,de)}(fe/t.current.getBoundingClientRect().width*100,j,R,O,h.current,u.current);ne.some((D,re)=>D!==he[re])&&l(he)},[n]);c.useLayoutEffect(()=>{h.current.elements=n,h.current.panels=i,h.current.widths=o},[n,i,o]);const w=Vr();c.useLayoutEffect(()=>{const{widths:P}=h.current;if(P.length===i.length)return;const k=w.get(i);if(k){const S=_t(i,k,window.innerWidth);return void l(S)}const j=function(S){let R=S.length,O=100;const I=S.map(_=>_.defaultSize?(O-=_.defaultSize,R-=1,_.defaultSize):null),z=O/R;return I.map(_=>_===null?z:_)}(i);l(j)},[w,i]),c.useEffect(()=>{o.length&&w.setDebounced(i,o)},[w,i,o]),c.useLayoutEffect(()=>{const P=new ResizeObserver(()=>{const{panels:k,widths:j}=h.current,S=_t(k,j,window.innerWidth);j.some((R,O)=>R!==S[O])&&l(S)});return P.observe(t.current),()=>{P.disconnect()}},[]);const y=c.useMemo(()=>({activeResizer:m,drag:v,getPanelStyle:p,registerElement:s,startDragging:g,stopDragging:b,unregisterElement:f}),[m,v,p,s,g,b,f]);return a.jsx(Te.Provider,{value:y,children:a.jsx(Jr,{ref:t,children:e})})},Hr=function(e){const{children:t,navigate:n}=e,r=c.useCallback((i,o=void 0)=>{n(o||{},i?{preview:i}:{})},[n]);return a.jsx(_n.Provider,{value:r,children:t})};function Xr(e){const{unstable_navigator:t}=e,n=!(t==null||!t.component),[r,i]=function(d,h){const[p,s]=c.useState(()=>{var f;return JSON.parse((f=localStorage.getItem(d))!=null?f:JSON.stringify(h))});return c.useEffect(()=>{localStorage.setItem(d,JSON.stringify(p))},[d,p]),[p,s]}("presentation/navigator",n),o=!!n&&r,l=c.useMemo(()=>{if(n)return()=>i(d=>!d)},[n,i]),m=c.useCallback(function(){return a.jsx(a.Fragment,{children:o&&a.jsx(Zr,{...t})})},[o,t]);return[{navigatorEnabled:o,toggleNavigator:l},m]}const Zr=c.memo(function(e){const{minWidth:t,maxWidth:n,component:r}=e,i=t!=null&&n!=null&&t===n;return a.jsxs(a.Fragment,{children:[a.jsx(Ge,{id:"navigator",minWidth:t,maxWidth:n,order:1,children:a.jsx(r,{})}),a.jsx(en,{order:2,disabled:i})]})}),Qr=function(e){const{children:t,params:n}=e,r=c.useMemo(()=>n,[n]);return a.jsx(On.Provider,{value:r,children:t})},Yr=function(e){const{children:t,deskParams:n,devMode:r,name:i,navigate:o,params:l}=e,m=c.useMemo(()=>({deskParams:n,devMode:r,name:i,navigate:o,params:l}),[n,r,i,o,l]);return a.jsx(Mt.Provider,{value:m,children:t})},st="ACTION_IFRAME_LOADED",Xe="ACTION_IFRAME_REFRESH",Ze="ACTION_IFRAME_RELOAD",Qe="ACTION_PERSPECTIVE",Ye="ACTION_VIEWPORT",rn="ACTION_VISUAL_EDITING_OVERLAYS_TOGGLE",ei=(e,t)=>{switch(t.type){case st:return e.iframe.status==="loaded"?e:{...e,iframe:{...e.iframe,status:"loaded"}};case Xe:return e.iframe.status==="refreshing"?e:{...e,iframe:{...e.iframe,status:"refreshing"}};case Ze:return e.iframe.status==="reloading"?e:{...e,iframe:{...e.iframe,status:"reloading"}};case Qe:return{...e,perspective:Je(on,t.perspective)};case Ye:return{...e,viewport:Je(an,t.viewport)};case rn:return ti(e,t);default:return e}},ti=(e,t)=>e.visualEditing.overlaysEnabled===t.enabled?e:{...e,visualEditing:{...e.visualEditing,overlaysEnabled:t.enabled}},ni=Oe(["loading","loaded","refreshing","reloading"]),on=Qt(Oe(["published","previewDrafts"]),"previewDrafts"),an=Qt(Oe(["desktop","mobile"]),"desktop"),ri=Pe({iframe:Pe({status:ni}),perspective:on,viewport:an,visualEditing:Pe({overlaysEnabled:function e(t,n){const[r,i]=qe(t,n);return{type:"boolean",expects:"boolean",async:!1,message:r,pipe:i,_parse(o,l){return typeof o=="boolean"?Zt(this,o,l):ot(this,e,o,l)}}}()})}),ii={iframe:{status:"loading"},perspective:"previewDrafts",viewport:"desktop",visualEditing:{overlaysEnabled:!1}};function oi(e){return Je(ri,{...ii,...e})}const ai=Lt(G.iframe`
  border: 0;
  max-height: 100%;
  width: 100%;
  display: block;
`),si=function(e){var t;const{basePath:n="/"}=((t=Wt())==null?void 0:t.activeWorkspace)||{},{fontSize:r=1,onChange:i,origin:o,padding:l=3,value:m}=e,d=c.useRef(null),[h,p]=c.useState(void 0),[s,f]=c.useState(void 0),u=c.useCallback(w=>{p(w.currentTarget.value)},[]),g=c.useCallback(w=>{var y;if(w.key==="Enter"){if(h===void 0)return;const P=h.startsWith("/")||h===""?`${o}${h}`:h;if(!P.startsWith(o+"/")&&P!==o)return void f(`URL must start with ${o}`);if(!o&&(P.startsWith(`${n}/`)||P===n))return void f(`URL can't have the same base path as the Studio ${n}`);const k=P===o?o+"/":P;f(void 0),p(void 0),i(k.slice(o.length)),(y=d.current)==null||y.blur()}w.key==="Escape"&&(f(void 0),p(void 0))},[n,i,o,h]),b=c.useCallback(()=>{f(void 0),p(void 0)},[]);c.useEffect(()=>{f(void 0),p(void 0)},[o,m]);const v=c.useMemo(()=>({icon:zn}),[]);return a.jsx(a.Fragment,{children:a.jsx(Tn,{clearButton:s?v:void 0,customValidity:s,fontSize:r,onBlur:b,onClear:()=>{f(void 0),p(o+m)},onChange:u,onKeyDownCapture:g,padding:l,style:{zIndex:1},radius:2,ref:d,space:l,value:h===void 0?`${o}${m}`:h})})};function ci(e){const{initialUrl:t,openPopup:n,previewLocationOrigin:r,previewLocationRoute:i}=e,o=c.useCallback(l=>{l.preventDefault(),n(l.currentTarget.href)},[n]);return a.jsxs(a.Fragment,{children:[a.jsx(li,{initialUrl:t,previewLocationOrigin:r,previewLocationRoute:i}),a.jsx(Ee,{icon:Ln,text:"Open preview",as:"a",href:`${r}${i}`,onClick:o,rel:"opener",target:"_blank"})]})}function li(e){const{initialUrl:t,previewLocationOrigin:n,previewLocationRoute:r}=e,{push:i}=Dn(),o=Be({apiVersion:Ke}),l=Ve(),[m,d]=c.useState(!1);return a.jsx(Ee,{disabled:m,onClick:()=>{if(navigator==null||!navigator.clipboard)return i({closable:!0,status:"error",title:"Clipboard not supported"}),!1;d(!0);let h,p=`${n}${r}`;const s=()=>{i({id:h,closable:!0,status:"success",title:"The URL is copied to the clipboard"}),d(!1)},f=u=>{i({closable:!0,status:"error",title:"Copy failed",description:u.message||u.toString()}),d(!1)};if(dr(t)&&typeof ClipboardItem<"u"){const u="text/plain",g=new ClipboardItem({[u]:(async()=>{h=i({closable:!0,title:"Copying URL to clipboard…"});const b=await Ht(o,"@sanity/presentation",typeof window>"u"?"":location.href,l==null?void 0:l.id);return p=pr(t,b.secret,r).toString(),new Blob([p],{type:u})})()});navigator.clipboard.write([g]).then(s).catch(f)}else navigator.clipboard.writeText(p).then(s).catch(f)},text:"Copy link",icon:Un})}const We=Lt(W),ui=G(Kn)`
  & > span {
    width: 21px;
    height: 13px;
    overflow: hidden;

    & > span:nth-child(1) {
      width: 21px;
      height: 13px;
    }

    & > span:nth-child(2) {
      width: 9px;
      height: 9px;
      top: 2px;
      left: 2px;
    }
  }

  & input:checked + span {
    & > span:nth-child(2) {
      transform: translate3d(8px, 0, 0) !important;
    }
  }
`,Ne={previewDrafts:"Drafts",published:"Published"},di="caution",pi="positive",Ot={previewDrafts:An,published:Mn},fi=c.forwardRef(function(e,t){const{dispatch:n,iframe:r,initialUrl:i,loadersConnection:o,navigatorEnabled:l,onPathChange:m,onRefresh:d,openPopup:h,overlaysConnection:p,params:s,perspective:f,targetOrigin:u,toggleNavigator:g,toggleOverlay:b,viewport:v,visualEditing:{overlaysEnabled:w}}=e,{devMode:y}=ze(),P=dn(),k=c.useCallback(()=>n({type:Ye,viewport:"desktop"}),[n]),j=c.useCallback(()=>n({type:Ye,viewport:"mobile"}),[n]),S=r.status==="loading"||r.status==="reloading",[R,O]=c.useState(!1),I=r.status==="refreshing",[z,_]=c.useState(!1),fe=S||I||p==="connecting",ne=c.useMemo(()=>u===location.origin?"":u,[u]),he=c.useCallback(()=>{d(()=>{typeof t=="function"||t==null||!t.current||(n({type:Ze}),t.current.src=`${u}${s.preview||"/"}`)})},[n,d,s.preview,u,t]),D=c.useCallback(()=>{typeof t=="function"||t==null||!t.current||(t.current.src=i.toString(),n({type:Ze}))},[n,t,i]),re=c.useCallback(()=>{ae(!0)},[]),[U,ae]=c.useState(!1),[se,me]=c.useState(!1);c.useEffect(()=>{if(!(S||I||p!=="connecting"&&p!=="reconnecting")){const N=setTimeout(()=>{me(!0)},1e3);return()=>clearTimeout(N)}},[p,S,I]),c.useEffect(()=>{if(!S&&!I&&se){if(p==="connected"&&(_(!1),me(!1),O(!1),ae(!1)),p==="connecting"){const N=setTimeout(()=>{O(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},dt);return()=>clearTimeout(N)}if(p==="reconnecting"){const N=setTimeout(()=>{O(!0),_(!0)},dt);return()=>clearTimeout(N)}p==="disconnected"&&_(!0)}},[S,p,I,se]);const H=c.useMemo(()=>{const N=new URL(s.preview||"/",u),{pathname:F,search:de}=ur(N);return`${F}${de}`},[s.preview,u]),ie=c.useCallback(()=>{n({type:st})},[n]);return c.useEffect(()=>{if(typeof t=="function"||t==null||!t.current)return;const N=t.current;function F(){N===document.activeElement&&N.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",F),()=>{window.removeEventListener("blur",F)}},[t]),a.jsx(Jn,{transition:P?{duration:0}:void 0,children:a.jsxs(pn,{delay:1e3,children:[a.jsx(oe,{flex:"none",padding:2,shadow:1,style:{position:"relative"},children:a.jsxs(W,{align:"center",gap:2,style:{minHeight:0},children:[g&&a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Toggle navigator"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(ee,{"aria-label":"Toggle navigator",fontSize:1,icon:fn,mode:"bleed",onClick:g,padding:3,selected:l})}),a.jsx(ye,{animate:!0,content:a.jsxs(W,{align:"center",style:{whiteSpace:"nowrap"},children:[a.jsx(te,{padding:1,children:a.jsx(L,{size:1,children:w?"Disable edit overlay":"Enable edit overlay"})}),a.jsx(te,{paddingY:1,children:a.jsx(hn,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})})]}),fallbackPlacements:["bottom-start"],padding:1,placement:"bottom",portal:!0,children:a.jsx(oe,{as:"label",flex:"none",padding:3,style:{lineHeight:0,borderRadius:999,userSelect:"none"},tone:w?"positive":void 0,children:a.jsxs(W,{align:"center",gap:2,children:[a.jsx("div",{style:{margin:-2},children:a.jsx(ui,{checked:w,onChange:b,disabled:r.status==="loading"||p!=="connected"})}),a.jsx(te,{children:a.jsx(L,{muted:!0,size:1,weight:"medium",children:"Edit"})})]})})}),a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:r.status==="loading"?"Loading…":r.status==="reloading"||r.status==="refreshing"?"Refreshing…":"Refresh preview"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(ee,{"aria-label":"Refresh preview",fontSize:1,icon:mn,mode:"bleed",loading:r.status==="reloading"||r.status==="refreshing",onClick:he,padding:3})}),a.jsx(te,{flex:1,children:a.jsx(si,{onChange:m,origin:ne,value:H})}),a.jsx(W,{align:"center",flex:"none",gap:1,children:a.jsx(pt,{button:a.jsx(ee,{fontSize:1,iconRight:vn,mode:"bleed",padding:3,space:2}),id:"location-menu",menu:a.jsx(ft,{children:a.jsx(ci,{initialUrl:i,openPopup:h,previewLocationOrigin:ne,previewLocationRoute:H})}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),a.jsx(W,{align:"center",flex:"none",gap:1,children:a.jsx(pt,{button:a.jsx(ee,{fontSize:1,iconRight:gn,mode:"bleed",padding:3,space:2,text:Ne[o==="connected"?f:"previewDrafts"],loading:o==="reconnecting"&&r.status!=="loaded",disabled:o!=="connected"}),id:"perspective-menu",menu:a.jsxs(ft,{style:{maxWidth:240},children:[a.jsx(Ee,{fontSize:1,onClick:()=>n({type:Qe,perspective:"previewDrafts"}),padding:3,pressed:f==="previewDrafts",tone:di,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(te,{flex:"none",children:a.jsx(L,{size:1,children:c.createElement(Ot.previewDrafts)})}),a.jsxs(ue,{flex:1,space:2,children:[a.jsx(L,{size:1,weight:"medium",children:Ne.previewDrafts}),a.jsx(L,{muted:!0,size:1,children:"View this page with latest draft content"})]}),a.jsx(te,{flex:"none",children:a.jsx(L,{muted:!0,size:1,style:{opacity:f==="previewDrafts"?1:0},children:a.jsx(ht,{})})})]})}),a.jsx(Ee,{fontSize:1,onClick:()=>n({type:Qe,perspective:"published"}),padding:3,pressed:f==="published",tone:pi,children:a.jsxs(W,{align:"flex-start",gap:3,children:[a.jsx(te,{flex:"none",children:a.jsx(L,{size:1,children:c.createElement(Ot.published)})}),a.jsxs(ue,{flex:1,space:2,children:[a.jsx(L,{size:1,weight:"medium",children:Ne.published}),a.jsx(L,{muted:!0,size:1,children:"View this page with published content"})]}),a.jsx(te,{flex:"none",children:a.jsx(L,{muted:!0,size:1,style:{opacity:f==="published"?1:0},children:a.jsx(ht,{})})})]})})]}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})}),a.jsxs(W,{align:"center",flex:"none",gap:1,children:[a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Full viewport"}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:a.jsx(ee,{"aria-label":"Full viewport",fontSize:1,icon:yn,mode:"bleed",onClick:k,padding:3,selected:v==="desktop"})}),a.jsx(ye,{animate:!0,content:a.jsx(L,{size:1,children:"Narrow viewport"}),padding:2,placement:"bottom",portal:!0,children:a.jsx(ee,{"aria-label":"Narrow viewport",fontSize:1,icon:wn,mode:"bleed",onClick:j,padding:3,selected:v==="mobile"})})]})]})}),a.jsx(oe,{flex:1,tone:"transparent",children:a.jsxs(W,{align:"center",height:"fill",justify:"center",padding:v==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:fe?"wait":void 0},children:[a.jsx(bn,{children:z||S||I||!se||U?(S||p==="connecting"&&r.status!=="refreshing")&&!U?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:a.jsxs(W,{style:{...$e[v]},justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(L,{muted:!0,size:1,children:"Loading…"})]})}):z&&!U?a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:hi,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute",borderTop:"1px solid transparent",boxShadow:"0 0 0 1px var(--card-border-color)"},children:a.jsx(at,{flex:1,message:"Could not connect to the preview",onRetry:D,onContinueAnyway:re,children:y&&a.jsxs(a.Fragment,{children:[p!=="connected"&&a.jsx(oe,{padding:3,radius:2,tone:"critical",children:a.jsxs(ue,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Overlay connection status"}),a.jsx(Ce,{size:1,children:p})]})}),o!=="connected"&&a.jsx(oe,{padding:3,radius:2,tone:"critical",children:a.jsxs(ue,{space:3,children:[a.jsx(Se,{muted:!0,size:0,children:"Loader connection status"}),a.jsx(Ce,{size:1,children:o})]})})]})})}):null:a.jsx(We,{initial:"initial",animate:"animate",exit:"exit",variants:zt,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:R?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:a.jsxs(W,{style:{...$e[v]},justify:"center",align:"center",direction:"column",gap:4,children:[R&&a.jsx(ee,{disabled:!0,fontSize:1,mode:"ghost",text:"Continue anyway",style:{opacity:0}}),a.jsx(oe,{radius:2,tone:R?"caution":"inherit",padding:4,shadow:1,children:a.jsxs(W,{justify:"center",align:"center",direction:"column",gap:4,children:[a.jsx(mt,{muted:!0}),a.jsx(L,{muted:!0,size:1,children:R?a.jsx(a.Fragment,{children:"Unable to connect, check the browser console for more information."}):"Connecting…"})]})}),R&&a.jsx(ee,{fontSize:1,tone:"critical",onClick:re,text:"Continue anyway"})]})})}),a.jsx(ai,{ref:t,style:{pointerEvents:(S||p==="connecting"&&r.status!=="refreshing")&&!U?"none":"auto",boxShadow:"0 0 0 1px var(--card-border-color)",borderTop:"1px solid transparent"},src:i.toString(),initial:["background"],variants:mi,animate:[(S||p==="connecting"&&r.status!=="refreshing")&&!U?"background":"active",S?"reloading":"idle",v,se&&!U?"timedOut":""],onLoad:ie})]})})]})})}),$e={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},zt={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},hi={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},mi={desktop:{...$e.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...$e.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};let Tt=!1;function vi(e){var t;if(e===void 0)return;const n=(t=decodeURIComponent(e))==null?void 0:t.split(".");return n[0]==="drafts"&&n.shift(),n.join(".")}function gi(e){if(e!==void 0)return Jt.toString(function(t){const n=[];for(const r of t.split(".")){const i=$r.exec(r);if(i){n.push(i[1],Number(i[2]));continue}const o=Ir.exec(r);if(o){n.push(o[1],[Number(o[2]),Number(o[3])]);continue}const l=Rr.exec(r);l?n.push(l[1],{_key:l[2]}):n.push(r)}return n}(decodeURIComponent(e)))}function Fe(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0&&t!==""&&t!==null))}function yi({initialPreviewUrl:e,routerNavigate:t,routerState:n,routerSearchParams:r,frameStateRef:i}){const o=c.useMemo(()=>{const{id:d,path:h,type:p}={id:vi((s=n).id),path:gi(s.path),type:s.type};var s;return{id:d,type:p,path:h,preview:r.preview||`${e.pathname}${e.search}`,perspective:r.perspective,viewport:r.viewport,inspect:r.inspect,rev:r.rev,since:r.since,template:r.template,templateParams:r.templateParams,view:r.view,pathKey:r.pathKey,instruction:r.instruction,comment:r.comment}},[n,r,e]),l=c.useMemo(()=>Fe({inspect:o.inspect,path:o.path,rev:o.rev,since:o.since,template:o.template,templateParams:o.templateParams,view:o.view,pathKey:o.pathKey,instruction:o.instruction,comment:o.comment}),[o.comment,o.inspect,o.instruction,o.path,o.pathKey,o.rev,o.since,o.template,o.templateParams,o.view]),m=c.useRef(n);return c.useEffect(()=>{m.current=n},[n]),{deskParams:l,navigate:c.useMemo(()=>tn((d,h={},p)=>{d.id&&(d.id=Bt(d.id));const{_searchParams:s,...f}=m.current,u=(s||[]).reduce((w,[y,P])=>(w[y]=P,w),{}),g=Fe({...f,...d}),b=Fe({...u,...h});f.id!==g.id&&(delete b.template,delete b.templateParams),g._searchParams=Object.entries(b).reduce((w,[y,P])=>[...w,[y,P]],[]);const v=p??b.preview===i.current.url;t(g,{replace:v})},50),[t,i]),params:o}}function wi(e,t,n){var r,i;const o=Be({apiVersion:Ke}),l=Wt(),m=((r=l==null?void 0:l.activeWorkspace)==null?void 0:r.basePath)||"/",d=((i=l==null?void 0:l.activeWorkspace)==null?void 0:i.name)||"default",h=function(s,f,u){const g=Ve();return c.useMemo(()=>["@sanity/presentation",f,u,s,g==null?void 0:g.id,bi],[f,g==null?void 0:g.id,s,u])}(t,m,d),p=function(s,f){const u=Be({apiVersion:Ke}),g=Ve(),[b,v]=c.useState(""),w=s?bt(async()=>await Ht(u,"@sanity/presentation",typeof window>"u"?"":location.href,g==null?void 0:g.id),[...f,b]):null;return c.useEffect(()=>{if(!w)return;const y=setTimeout(()=>{c.startTransition(()=>v(w.expiresAt.toString()))},w.expiresAt.getTime()-Date.now());return()=>clearTimeout(y)},[w]),(w==null?void 0:w.secret)||null}(typeof e=="object"||typeof e=="function",h);return bt(async()=>{if(typeof e=="string"){const f=new URL(e,location.origin);let u=f;try{if(n){const g=new URL(n,f);g.origin===f.origin&&(u=g)}else if(document.referrer){const g=new URL(document.referrer);g.origin===f.origin&&(u=g)}}catch{}return location.origin!==u.origin||!u.pathname.startsWith(`${m}/`)&&u.pathname!==m?u:f}const s=await(typeof e=="object"?fr(e):e)({client:o,previewUrlSecret:p,previewSearchParam:n,referrer:typeof document>"u"?null:document.referrer,studioBasePath:m});return new URL(s,location.origin)},[...h,p])}const bi=Symbol(),xi=c.lazy(()=>Dt(()=>import("./LoaderQueries-69ff5c4d.js"),["static/LoaderQueries-69ff5c4d.js","static/sanity-f7d63e82.js","static/DisplayedDocumentBroadcaster-c7e74e05.js"])),ji=c.lazy(()=>Dt(()=>import("./PostMessageRefreshMutations-7435675a.js"),["static/PostMessageRefreshMutations-7435675a.js","static/sanity-f7d63e82.js"])),ki=G(W)`
  overflow-x: auto;
`;function Pi(e){var t;const{previewUrl:n,components:r}=(t=e.tool.options)!=null?t:{},i=e.tool.name||xn,{unstable_navigator:o}=r||{},{navigate:l,state:m}=Ut(),d=At(Object.fromEntries(m._searchParams||[])),h=wi(n||"/",i,d.preview||null),[p]=c.useState(()=>{var E;const C=(E=e.tool.options)==null?void 0:E.devMode;return typeof C=="function"?C():typeof C=="boolean"?C:typeof window<"u"&&window.location.hostname==="localhost"}),s=c.useMemo(()=>h.origin,[h.origin]),f=c.useRef(null),[u,g]=c.useState(),[b,v]=c.useState({}),w=c.useRef({title:void 0,url:void 0}),{params:y,deskParams:P,navigate:k}=yi({initialPreviewUrl:h,routerNavigate:l,routerState:m,routerSearchParams:d,frameStateRef:w}),[j,S]=c.useReducer(ei,{perspective:y.perspective,viewport:y.viewport},oi),[R,O]=function(E,C){if(E!=="published"&&E!=="previewDrafts")throw new Error(`Invalid perspective: ${E}`);const[T,$]=c.useState({}),[x,q]=c.useState({}),B=c.useRef(""),ce=c.useCallback((K,A,le=[])=>{const J=le.filter(Y=>"_projectId"in Y&&Y._projectId?(Tt||(console.warn("Cross dataset references are not supported yet, ignoring source document",Y),Tt=!0),!1):Y);(A==="published"?$:q)(Y=>{const ge={};for(const be of J)ge[be._id]=be;if(B.current!==C.current.url)return B.current=C.current.url,{[K]:ge};const we=Y[K];return Vn(we,ge)?Y:{...Y,[K]:ge}})},[C]);return[c.useMemo(()=>{const K=Object.values(E==="published"?T:x).reduce((A,le)=>(Object.values(le).forEach(J=>{A[J._id]=J}),A),{});return Object.values(K)},[E,x,T]),ce]}(j.perspective,w),I=jn(),z=kn();c.useEffect(()=>{(j.perspective!==y.perspective||j.viewport!==y.viewport)&&k({},{perspective:j.perspective==="previewDrafts"?void 0:j.perspective,viewport:j.viewport==="desktop"?void 0:j.viewport})},[y.perspective,j.perspective,k,j.viewport,y.viewport]);const[_,fe]=c.useState("connecting"),[ne,he]=c.useState("connecting"),[D,re]=c.useState("connecting"),[U]=c.useState(()=>new Set),ae=c.useCallback(E=>{const C=window.open(E,"_blank");C&&U.add(C)},[U]);c.useEffect(()=>{if(U.size&&u)for(const E of U)E&&"closed"in E&&!E.closed&&u.addSource(E)},[u,U,U.size]),c.useEffect(()=>{var E;const C=(E=f.current)==null?void 0:E.contentWindow;if(!C)return;const T=function($){const{destroy:x,send:q}=kt($),B=new Set,ce=new WeakMap,K=new Set;return{destroy:()=>{x();for(const A of K)A()},send:(A,...le)=>{q(A,...le);for(const J of B)J&&"closed"in J&&!J.closed&&ce.has(J)&&ce.get(J)(A,...le)},addSource(A){if(B.has(A))return;if(!("closed"in A))throw console.warn("Source is unsupported",{source:A}),new Error("Source is unsupported");if(A.closed)throw new Error("Source is closed");const{send:le,destroy:J}=kt({...$,target:A,connectTo:$.connectTo.map(Y=>{const{onStatusUpdate:ge,onEvent:we,...be}=Y;return{...be,onEvent:we?(...lt)=>{const[De]=lt;if(De!=="preview-kit/documents"&&De!=="overlay/navigate"&&De!=="loader/documents")return we(...lt)}:void 0}})});K.add(J),ce.set(A,le),B.add(A)}}}({id:"presentation",target:C,targetOrigin:s,connectTo:[{id:"overlays",heartbeat:!0,onStatusUpdate:fe,onEvent($,x){if($!=="visual-editing/focus"&&$!=="overlay/focus"||!("id"in x))if($==="visual-editing/navigate"||$==="overlay/navigate"){const{title:q,url:B}=x;w.current.url!==B&&k({},{preview:B}),w.current={title:q,url:B}}else $==="visual-editing/meta"?w.current.title=x.title:$==="visual-editing/toggle"||$==="overlay/toggle"?S({type:rn,enabled:x.enabled}):$==="visual-editing/documents"?O("visual-editing",x.perspective,x.documents):$==="visual-editing/refreshing"&&x.source==="manual"?clearTimeout(Q.current):$==="visual-editing/refreshing"&&x.source==="mutation"?S({type:Xe}):$==="visual-editing/refreshed"&&S({type:st});else k({type:x.type,id:x.id,path:x.path})}},{id:"loaders",heartbeat:!0,onStatusUpdate:he,onEvent($,x){if($==="loader/documents"&&x.projectId===I&&x.dataset===z)O("loaders",x.perspective,x.documents);else if($==="loader/query-listen"&&x.projectId===I&&x.dataset===z){if(typeof x.heartbeat=="number"&&x.heartbeat<Ue)throw new Error(`Loader query listen heartbeat interval must be at least ${Ue}ms`);v(q=>{var B,ce,K;return{...q,[(ce=x.query,K=x.params,`${ce}-${typeof K=="string"?K:JSON.stringify(K)}`)]:{perspective:x.perspective,query:x.query,params:x.params,receivedAt:Date.now(),heartbeat:(B=x.heartbeat)!=null&&B}}})}}},{id:"preview-kit",heartbeat:!0,onStatusUpdate:re,onEvent($,x){$==="preview-kit/documents"&&x.projectId===I&&x.dataset===z&&O("preview-kit",x.perspective,x.documents)}}]});return g(T),()=>{T.destroy(),g(void 0)}},[z,I,O,k,s]),c.useEffect(()=>{const E=setInterval(()=>c.startTransition(()=>v(C=>{if(Object.keys(C).length<1)return C;const T=Date.now();if(!Object.values(C).some(x=>x.heartbeat!==!1&&T>x.receivedAt+x.heartbeat))return C;const $={};for(const[x,q]of Object.entries(C))q.heartbeat!==!1&&T>q.receivedAt+q.heartbeat||($[x]=q);return $})),Ue);return()=>clearInterval(E)},[]);const se=c.useCallback(E=>{k({path:Jt.toString(E)},{},!0)},[k]),me=c.useCallback(E=>{const C=new URL(E,h.origin),T=C.pathname+C.search;C.origin===h.origin&&T!==y.preview&&k({},{preview:T})},[h,y,k]),H=c.useCallback(E=>{k({},E)},[k]);c.useEffect(()=>{u==null||u.send("overlays","presentation/perspective",{perspective:j.perspective})},[u,j.perspective]),c.useEffect(()=>{y.id&&y.path?u==null||u.send("overlays","presentation/focus",{id:y.id,path:y.path}):u==null||u.send("overlays","presentation/blur",void 0)},[u,y.id,y.path]),c.useEffect(()=>{w.current.url&&y.preview&&w.current.url!==y.preview&&(w.current.url=y.preview,_!=="connected"&&f.current?f.current.src=`${s}${y.preview}`:u==null||u.send("overlays","presentation/navigate",{url:y.preview,type:"replace"}))},[u,_,s,y.preview]);const ie=c.useCallback(()=>u==null?void 0:u.send("overlays","presentation/toggleOverlay",void 0),[u]),[N,F]=c.useState(null);c.useEffect(()=>{const E=T=>{Et(T)&&ie()},C=T=>{var $;Et(T)&&ie(),$=T,["mod","\\"].every(x=>Pt[x]?$[Pt[x]]:$.key===x.toUpperCase())&&ie()};return window.addEventListener("keydown",C),window.addEventListener("keyup",E),()=>{window.removeEventListener("keydown",C),window.removeEventListener("keyup",E)}},[ie]);const[de,pe]=c.useState(null),[{navigatorEnabled:ve,toggleNavigator:X},Z]=Xr({unstable_navigator:o}),V=c.useRef(y.id);c.useEffect(()=>{y.rev&&V.current&&y.id!==V.current&&k({},{rev:void 0}),V.current=y.id});const Q=c.useRef(),Le=c.useCallback(E=>{if(S({type:Xe}),u)return Q.current=window.setTimeout(E,300),void u.send("overlays","presentation/refresh",{source:"manual",livePreviewEnabled:D==="connected"||ne==="connected"});E()},[u,ne,D]),ct=Pn(),sn=c.useCallback(({id:E,type:C,path:T})=>{if(w.current.url)return{title:w.current.title||w.current.url,name:"edit",params:{id:E,path:T,type:C,inspect:En,workspace:ct.name,mode:Sn,preview:y.preview}}},[y.preview,ct.name]);return a.jsxs(a.Fragment,{children:[a.jsx(Yr,{deskParams:P,devMode:p,name:i,params:y,navigate:k,children:a.jsx(Hr,{navigate:k,children:a.jsx(Qr,{params:y,children:a.jsx(ki,{height:"fill",children:a.jsxs(Gr,{children:[a.jsx(Z,{}),a.jsx(Ge,{id:"preview",minWidth:325,defaultSize:ve?50:75,order:3,children:a.jsx(W,{direction:"column",flex:1,height:"fill",ref:pe,children:a.jsx(Cn,{element:de,children:a.jsx(fi,{dispatch:S,iframe:j.iframe,initialUrl:h,loadersConnection:ne,navigatorEnabled:ve,onPathChange:me,onRefresh:Le,openPopup:ae,overlaysConnection:_,params:y,perspective:j.perspective,ref:f,targetOrigin:s,toggleNavigator:X,toggleOverlay:ie,viewport:j.viewport,visualEditing:j.visualEditing})})})}),a.jsx(en,{order:4}),a.jsx(Ge,{id:"content",minWidth:325,order:5,children:a.jsx(qn,{documentId:y.id,setDisplayedDocument:F,children:a.jsx($n,{getIntent:sn,children:a.jsx(Nr,{refs:R,deskParams:P,documentId:y.id,documentType:y.type,onDeskParams:H,onFocusPath:se,previewUrl:y.preview})})})})]})})})})}),u&&a.jsx(c.Suspense,{children:a.jsx(xi,{channel:u,liveQueries:b,perspective:j.perspective,liveDocument:N,documentsOnPage:R})}),u&&y.id&&y.type&&a.jsx(c.Suspense,{children:a.jsx(ji,{channel:u,id:y.id,type:y.type,loadersConnection:ne,previewKitConnection:D})})]})}const Ri=Object.freeze(Object.defineProperty({__proto__:null,default:Pi},Symbol.toStringTag,{value:"Module"}));export{vt as D,Ri as P,Xn as a,Ci as g,$i as p,Ii as r,Zn as t,Ae as w};
